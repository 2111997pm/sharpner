<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker with CRUD and Local Storage</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        /* Styles remain the same as before */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }

        table {
            width: 50%;
            margin: 20px auto;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 10px;
            border: 1px solid #ddd;
        }

        th {
            background-color: #f2f2f2;
        }

        select,
        input {
            padding: 8px;
            margin-bottom: 10px;
        }

        button {
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }

        body {
            margin: 0;
        }
    </style>
</head>

<body>

    <h2 class="bg-success text-center p-4"> Expense Tracker</h2>
    <div class="container-fluid bg-info p-4 text-white">

        <label for="amount">Amount: </label>
        <input type="number" id="amount" placeholder="Enter amount">

        <label for="category">Category: </label>
        <select id="category">
            <option value="food">Food</option>
            <option value="transportation">Transportation</option>
            <option value="utilities">Utilities</option>
            <option value="entertainment">Entertainment</option>
            <!-- Add more categories as needed -->
        </select>

        <label for="description">Description: </label>
        <input type="text" id="description" placeholder="Enter description">

        <button onclick="addExpense()">Add Expense</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>Category</th>
                <th>Amount</th>
                <th>Description</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="expenseTableBody">
        </tbody>
        <tfoot>
            <tr>
                <td>Total:</td>
                <td id="totalAmount">0</td>
                <td></td>
                <td></td>
            </tr>
        </tfoot>
    </table>

    <script>
        let total = 0;
        let editingExpense = null;
        let expenses = [];

        // Load expenses from local storage
        if (localStorage.getItem('expenses')) {
            expenses = JSON.parse(localStorage.getItem('expenses'));
            renderTable();
            updateTotal();
        }

        function addExpense() {
            const amountInput = document.getElementById('amount');
            const categorySelect = document.getElementById('category');
            const descriptionInput = document.getElementById('description');

            const amount = parseFloat(amountInput.value);
            const category = categorySelect.value;
            const description = descriptionInput.value;

            if (isNaN(amount) || amount <= 0) {
                alert('Please enter a valid amount.');
                return;
            }

            if (editingExpense) {
                // Update existing expense
                total -= editingExpense.amount;
                editingExpense.category = category;
                editingExpense.amount = amount;
                editingExpense.description = description;
                editingExpense = null;
            } else {
                // Add new expense
                const newExpense = {
                    category: category,
                    amount: amount,
                    description: description
                };
                expenses.push(newExpense);
            }

            // Save expenses to local storage
            localStorage.setItem('expenses', JSON.stringify(expenses));

            // Update total and render table
            updateTotal();
            renderTable();

            // Clear input fields
            amountInput.value = '';
            descriptionInput.value = '';
        }

        function editExpense(index) {
            const expense = expenses[index];
            document.getElementById('amount').value = expense.amount;
            document.getElementById('category').value = expense.category;
            document.getElementById('description').value = expense.description;
            editingExpense = expense;
        }

        function deleteExpense(index) {
            const expense = expenses[index];
            total -= expense.amount;
            document.getElementById('totalAmount').textContent = total.toFixed(2);
            expenses.splice(index, 1);

            // Save expenses to local storage
            localStorage.setItem('expenses', JSON.stringify(expenses));

            renderTable();
        }

        function renderTable() {
            const tableBody = document.getElementById('expenseTableBody');
            tableBody.innerHTML = '';

            for (let i = 0; i < expenses.length; i++) {
                const expense = expenses[i];

                const row = tableBody.insertRow();
                const cell1 = row.insertCell(0);
                const cell2 = row.insertCell(1);
                const cell3 = row.insertCell(2);
                const cell4 = row.insertCell(3);

                cell1.textContent = expense.category;
                cell2.textContent = expense.amount.toFixed(2);
                cell3.textContent = expense.description;

                const editButton = document.createElement('button');
                editButton.textContent = 'Edit';
                editButton.onclick = function () {
                    editExpense(i);
                };
                cell4.appendChild(editButton);

                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Delete';
                deleteButton.onclick = function () {
                    deleteExpense(i);
                };
                cell4.appendChild(deleteButton);
            }
        }

        function updateTotal() {
            total = expenses.reduce((sum, expense) => sum + expense.amount, 0);
            document.getElementById('totalAmount').textContent = total.toFixed(2);
        }
    </script>
</body>

</html>
